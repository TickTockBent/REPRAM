<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Discovery Test</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background: #0a0a0a; color: white; }
        button { padding: 10px; margin: 5px; }
        #log { background: #1a1a2e; padding: 10px; margin-top: 20px; height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>Simple Discovery Protocol Test</h1>
    <button id="addNodeBtn">Add Node</button>
    <button id="showStatsBtn">Show Stats</button>
    
    <div id="log"></div>
    <div id="stats"></div>

    <script>
        console.log('Script starting...');
        
        class SimpleDiscovery {
            constructor() {
                console.log('Constructor called');
                this.nodes = new Map();
                this.nodeCounter = 1;
                
                // Add root nodes
                this.nodes.set('root1', { id: 'root1', type: 'root', children: [] });
                this.nodes.set('root2', { id: 'root2', type: 'root', children: [] });
                this.nodes.set('root3', { id: 'root3', type: 'root', children: [] });
                
                this.log('Initialized with 3 root nodes');
                
                // Set up event handlers
                document.getElementById('addNodeBtn').addEventListener('click', () => {
                    console.log('Add node button clicked');
                    this.addNode();
                });
                
                document.getElementById('showStatsBtn').addEventListener('click', () => {
                    console.log('Show stats button clicked');
                    this.showStats();
                });
                
                console.log('Setup complete');
            }
            
            addNode() {
                const nodeId = `node-${this.nodeCounter++}`;
                console.log('Adding node:', nodeId);
                
                this.nodes.set(nodeId, { 
                    id: nodeId, 
                    type: 'leaf', 
                    parent: 'root1',
                    children: [] 
                });
                
                this.log(`Added ${nodeId}`);
                this.showStats();
            }
            
            showStats() {
                const stats = document.getElementById('stats');
                stats.innerHTML = `<h3>Stats</h3><p>Total nodes: ${this.nodes.size}</p>`;
            }
            
            log(message) {
                const logDiv = document.getElementById('log');
                const time = new Date().toLocaleTimeString();
                logDiv.innerHTML += `<div>[${time}] ${message}</div>`;
                logDiv.scrollTop = logDiv.scrollHeight;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, creating simulation...');
            window.sim = new SimpleDiscovery();
        });
    </script>
</body>
</html>